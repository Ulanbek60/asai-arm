<odoo>

  <record id="view_arm_task_list" model="ir.ui.view">
    <field name="name">arm.task.list</field>
    <field name="model">arm.task</field>
    <field name="arch" type="xml">
      <list string="Задания"
            decoration-warning="state == 'in_progress'"
            decoration-danger="state == 'scrap'">
        <field name="name"/>
        <field name="workcenter_id"/>
        <field name="priority"/>
        <field name="status_label"/>
        <field name="start_time"/>
        <field name="end_time"/>
        <field name="assigned_user_ids" widget="many2many_tags"/>
        <field name="state"/>

        <button name="action_take" type="object" string="Взять в работу"
                invisible="state in ('done', 'scrap')"/>

        <button name="action_done" type="object" string="ГОТОВО" class="btn-primary"
                invisible="state != 'in_progress'"/>

        <button name="action_scrap_open" type="object" string="БРАК" class="btn-danger"
                invisible="state in ('done', 'scrap')"/>

        <button name="action_block" type="object" string="НЕТ ВОЗМОЖНОСТИ"
                invisible="state in ('done', 'scrap', 'blocked')"/>
      </list>
    </field>
  </record>

  <record id="view_arm_task_form" model="ir.ui.view">
    <field name="name">arm.task.form</field>
    <field name="model">arm.task</field>
    <field name="arch" type="xml">
      <form string="Задание">
        <header>
          <button name="action_take" type="object" string="Взять в работу"
                  invisible="state in ('in_progress','done','scrap')"/>
          <button name="action_done" type="object" string="ГОТОВО" class="btn-primary"
                  invisible="state != 'in_progress'"/>
          <button name="action_scrap_open" type="object" string="БРАК" class="btn-danger"
                  invisible="state in ('done','scrap')"/>
          <button name="action_block" type="object" string="НЕТ ВОЗМОЖНОСТИ"
                  invisible="state in ('done','scrap','blocked')"/>
          <field name="state" widget="statusbar"
                 statusbar_visible="ready,in_progress,done,scrap,blocked"/>
        </header>

        <sheet>
          <group>
            <field name="name"/>
            <field name="workcenter_id"/>
            <field name="priority"/>
          </group>

          <group>
            <field name="assigned_user_ids" widget="many2many_tags"/>
            <field name="operator_id"/>
          </group>

          <group>
            <field name="planned_start"/>
            <field name="planned_end"/>
          </group>

          <group>
            <field name="start_time"/>
            <field name="end_time"/>
            <field name="duration" readonly="1"/>
          </group>

          <group invisible="state != 'scrap'">
            <field name="scrap_reason_id"/>
          </group>

          <group invisible="state != 'blocked'">
            <field name="block_reason_id"/>
            <field name="block_notes"/>
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <record id="action_arm_task_all" model="ir.actions.act_window">
    <field name="name">Все задания</field>
    <field name="res_model">arm.task</field>
    <field name="view_mode">list,form,kanban,pivot,graph</field>
    <field name="context">{'search_default_state_not_done': 1}</field>
  </record>

  <record id="action_arm_task_my" model="ir.actions.act_window">
    <field name="name">Мои задания</field>
    <field name="res_model">arm.task</field>
    <field name="view_mode">list,form,kanban</field>
    <field name="domain">['|',('assigned_user_ids','in',uid),('state','=','ready')]</field>

  </record>


</odoo>
